name: "üå∏ Welcome New Contributors - Bharat-Bhakti-Yatra"

on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]

jobs:
  welcome:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Post Welcome Message
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            // Extract context details
            const { actor, repo: { owner, repo }, issue: { number: issue_number } } = context;

            // Divine welcome message
            const message = `
            üå∏ **Namaste @${actor}!**

            Welcome to **Bharat-Bhakti-Yatra** ‚Äî a sacred digital pilgrimage celebrating unity, devotion, and the timeless soul of India.  
            Thank you for opening a new issue or pull request and becoming part of this divine journey. üåº

            üôè **Your Contribution Matters:**  
            Every issue or PR you raise helps shape a harmonious spiritual experience ‚Äî one that connects hearts across India‚Äôs vibrant communities: **Hindu, Muslim, Sikh, Jain, Christian, Buddhist, and beyond.**  
            Together, we‚Äôre crafting a shared space of love, culture, and spiritual growth.

            üîπ **Our Process:**  
            The core team will review your submission soon.  
            Please provide any additional details or insights to help us make Bharat-Bhakti-Yatra even more inclusive, soulful, and impactful.

            üå∫ **Tip:**  
            Use clear and descriptive labels for your issue or PR to help us manage and prioritize effectively.

            ‚ú® **About Bharat-Bhakti-Yatra**  
            Welcome to **Bharat-Bhakti!** üôè  
            Join hands in a spiritual journey that unites India‚Äôs diverse faiths ‚Äî **Hindu, Muslim, Sikh, Jain, Buddhist, Christian**, and more ‚Äî in a grand celebration of oneness.  
            Experience the **essence of divine love, peace, and harmony** as we walk this sacred path together.  
            This project is a tribute to **India‚Äôs eternal spirit**, where faiths converge, hearts connect, and souls rise.  
            Let your spirit be part of this divine awakening ‚Äî **diverse, sacred, and beautifully united.** üáÆüá≥

            üí´ **Project Author & Maintainer:**  
            **Ujjwal Saini** ‚Äî Creator & Visionary behind Bharat-Bhakti-Yatra  
            üîó [GitHub Profile](https://github.com/UjjwalSaini07)  
            üåê [Portfolio Website](https://ujjwalsaini.dev)  
            üíå Connect, collaborate, and contribute to spread unity through devotion.

            ‚ú® *Together, let‚Äôs walk this path of light, unity, and devotion. Jai Bharat!* üôè
            `;

            // Post comment using GitHub API
            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number,
              body: message.trim(),
            });

      - name: Add Welcome Label
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const owner = context.repo.owner;
            const repo = context.repo.repo;
            const issue_number = context.issue.number;

            // Fetch existing labels
            const { data: issue } = await github.rest.issues.get({
              owner,
              repo,
              issue_number
            });

            const labels = issue.labels.map(label => label.name);
            if (!labels.includes('welcome')) {
              await github.rest.issues.addLabels({
                owner,
                repo,
                issue_number,
                labels: ['welcome']
              });
              console.log(`üè∑Ô∏è Added 'welcome' label to #${issue_number}`);
            } else {
              console.log(`‚ö†Ô∏è 'welcome' label already exists for #${issue_number}`);
            }
